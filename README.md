# Auto Emailer

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Ç–±–æ—Ä–∞**

–ü—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Excel‚Äë—Ñ–∞–π–ª–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∏ —Ä–∞—Å—Å—ã–ª–∞—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –∏–ª–∏ –Ω–µ–ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É _Nfactorial Incubator_. –í—Å–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `config.json` –∏ `.env`.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

project_root/
‚îú‚îÄ config.json            # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ (–ø—É—Ç–∏, –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫, —Ç–µ–º–∞ –ø–∏—Å—å–º–∞)
‚îú‚îÄ .env                   # –°–µ–∫—Ä–µ—Ç—ã –¥–ª—è SMTP (–ª–æ–≥–∏–Ω, –ø–∞—Ä–æ–ª—å)
‚îú‚îÄ monitor_results.py     # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ —Ä–∞—Å—Å—ã–ª–∫–∏
‚îú‚îÄ templates/             # Jinja2-—à–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º
‚îÇ  ‚îú‚îÄ passed.j2           # –®–∞–±–ª–æ–Ω –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
‚îÇ  ‚îî‚îÄ failed.j2           # –®–∞–±–ª–æ–Ω –¥–ª—è –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
‚îú‚îÄ requirements.txt       # –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è pip
‚îî‚îÄ README.md              # –¢–µ–∫—É—â–∏–π —Ñ–∞–π–ª

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/shishl0/AutoMailer_N
   cd AutoMailer_N

	2.	–°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

python3 -m venv venv
source venv/bin/activate


	3.	–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

pip install -r requirements.txt



‚∏ª

üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

1. .env

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —É–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SMTP:

SMTP_HOST=smtp.sendgrid.net      # –∏–ª–∏ smtp.gmail.com –∏ —Ç.–¥.
SMTP_PORT=587
SMTP_USER=–≤–∞—à_–ª–æ–≥–∏–Ω             # e-mail –∏–ª–∏ "apikey" –¥–ª—è SendGrid
SMTP_PASS=–≤–∞—à_–ø–∞—Ä–æ–ª—å_–∏–ª–∏_APIkey

2. config.json

–§–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞. –ü—Ä–∏–º–µ—Ä –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:

{
  "excel_path": "results.xlsx",
  "header_row": 1,
  "columns": {
    "fio": "–§–ò–û",
    "email": "–ø–æ—á—Ç–∞",
    "result": "—Ä–µ–∑—É–ª—å—Ç–∞—Ç"
  },
  "needed_columns": ["–§–ò–û", "–ø–æ—á—Ç–∞", "—Ä–µ–∑—É–ª—å—Ç–∞—Ç"],
  "subject": "–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–±–æ—Ä–∞ –≤ Nfactorial Incubator",
  "templates_dir": "templates",
  "log_file": "mailer.log"
}

	‚Ä¢	excel_path ‚Äî –∏–º—è –∏–ª–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É Excel.
	‚Ä¢	header_row ‚Äî –∏–Ω–¥–µ–∫—Å —Å—Ç—Ä–æ–∫–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ (—Å—á–∏—Ç–∞—è –æ—Ç 0).
	‚Ä¢	columns ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–µ–π –∫ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∫–æ–ª–æ–Ω–æ–∫ –≤ Excel.
	‚Ä¢	needed_columns ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–Ω–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–Ω—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.
	‚Ä¢	subject ‚Äî —Ç–µ–º–∞ –ø–∏—Å—å–º–∞.
	‚Ä¢	templates_dir ‚Äî –ø–∞–ø–∫–∞ —Å Jinja2-—à–∞–±–ª–æ–Ω–∞–º–∏.
	‚Ä¢	log_file ‚Äî –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –≤ config.json –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—Å—è –ø–æ–ª–µ last_processed_row, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

‚∏ª

üöÄ –ó–∞–ø—É—Å–∫

python monitor_results.py

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–µ–∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ä–∞–Ω–µ–µ —Å—Ç—Ä–æ–∫, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–π–¥—ë—Ç –≤ —Ä–µ–∂–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ —Ñ–∞–π–ª–∞ Excel. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ results.xlsx –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –Ω–æ–≤—ã–µ –ø–∏—Å—å–º–∞.

‚∏ª

üìÑ –®–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º

–í –ø–∞–ø–∫–µ templates/ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ñ–∞–π–ª—ã —à–∞–±–ª–æ–Ω–æ–≤ (.j2), –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Jinja2:
	‚Ä¢	passed.j2 ‚Äî –ø–æ–∑–¥—Ä–∞–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –∏–º–µ—é—â–∏—Ö –ø—Ä–æ—à–µ–ª.
	‚Ä¢	failed.j2 ‚Äî —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö –∫–∞–∫ –Ω–µ –ø—Ä–æ—à–µ–ª.

–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–æ–≤ –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å HTML‚Äë–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ.

‚∏ª

üìù –õ–æ–≥–∏

–õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ config.json (mailer.log). –í –ª–æ–≥–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è —É–¥–∞—á–Ω—ã–µ –∏ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏.

‚∏ª
